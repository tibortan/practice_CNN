# practice_CNN

# 1.背景
chatGPT爆火后，重新燃起我对AI的学习欲望，经过一段时间的了解后，我觉得仅仅学习会AI工具的使用并不能满足自己，需要对底层的技术有一定了解，于是想通过搭建一个简单的模型来进行学习。  
在搭建简单模型的过程中，既可以建立一个大概的技术基础，同时可以延伸去了解到更高级、更前沿的技术。  
毕业四年来一直没有写过代码，而这次代码编写有chatGPT的协助，体验了一下他强大的code协助功能，也持续训练了自己的prompt能力。  
AI协助人类学习代码与知识，人类通过学习到的代码与知识加强AI，这何尝不是一种正反馈，所以未来AI发展会越来越快。  
# 2.项目概述
本项目通过搭建一个简单的CNN模型，来实现对脑部MRI图像与膝部MRI图像的分类。  
技术框架：pytorch  
# 3.项目内容
3.1 mri_out  
这部分是本项目的数据集，train文件夹保存训练集共297张图片，validation文件夹保存验证集共221张图片（主要是膝部mri图片太少，防止模型对脑部mri图像过拟合，删除了训练集部分mri图片），两者都通过文件夹名称区分图片的label。 
这里未将原数据与处理过程放上来，脑部mri由.nii文件处理而来，膝部mri由.dmc文件处理而来，都是通过matplotlib.pyplot.imshow进行的转换。  

3.2 classify.py  
这是CNN模型的主体：  
第一部分定义了dataset函数，可以通过路径引入图片，并将其转换为chennel为1，大小为512*512的张量，同时以文件夹名作为label； 
第二部分通过dataset引入训练数据与验证数据，并装到dataloarder中，设定批大小； 
第三部分创建了卷积模型，大体上是模拟了VGG，他由三层卷积层，三层池化层，三层线性层组成，这里未使用激活层。然后用交叉熵计算损失函数，设定学习率，并使用GPU进行加速；  
第四部分进行了10轮的模型训练与验证，并输出训练进度、累计损失、验证情况。  

3.3 dataset_test.py  
这是进行dataset方法的验证，额外进行了图片输出与张量输出，故没有用debug去实现  
# 4.项目结果
当超参数为：batch_size=2, shuffle=True, learning_rate = 0.01, epoch = 10时，某一次训练的各轮训练结果为：  
第一轮：整体测试集上的Loss: 7.660618174355477；整体测试集上的正确率: 0.9909502863883972  
第二轮：整体测试集上的Loss: 4.776575728901605；整体测试集上的正确率: 0.995475172996521  
第三轮：整体测试集上的Loss: 38.15692577993855；整体测试集上的正确率: 0.8642534017562866  
第四轮：整体测试集上的Loss: 1.0654266259790717；整体测试集上的正确率: 0.995475172996521  
第五轮：整体测试集上的Loss: 0.5957205421161333；整体测试集上的正确率: 1.0  
第六轮：整体测试集上的Loss: 1.6855196110480222；整体测试集上的正确率: 0.995475172996521  
第七轮：整体测试集上的Loss: 0.6424854110356364；整体测试集上的正确率: 0.995475172996521  
第八轮：整体测试集上的Loss: 0.8335843433450627；整体测试集上的正确率: 0.995475172996521  
第九轮：整体测试集上的Loss: 0.7798922897190721；整体测试集上的正确率: 0.995475172996521  
第十轮：整体测试集上的Loss: 0.5963105933623183；整体测试集上的正确率: 0.995475172996521  
可以看到，损失基本上呈下降趋势，正确率一直比较稳定  
# 5.感谢
脑部mri数据集：MICCAI_BraTS2018  
膝部mri数据集：https://download.csdn.net/download/gsq18871455101/9646278  
b站教程：https://www.bilibili.com/video/BV1hE411t7RN  
基本操作：https://jibencaozuo.com/zh-Hans/  
chatGPT3.5
